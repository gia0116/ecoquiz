<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>생태·환경 퀴즈 — 뱀파이어 스타일</title>
<style>
  :root{
    --bg1: #0b0b0b;
    --bg2: #11060a;
    --accent: #b9142f; /* crimson */
    --muted: #9a8f95;
    --glass: rgba(255,255,255,0.04);
    --card: rgba(255,255,255,0.03);
    --glow: 0 8px 30px rgba(185,20,47,0.25);
  }
  *{box-sizing:border-box;margin:0;padding:0}
  html,body,#app{height:100%}
  body{
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Noto Sans KR", "Apple SD Gothic Neo", "Malgun Gothic", sans-serif;
    background: radial-gradient(circle at 20% 10%, rgba(185,20,47,0.06) 0%, transparent 12%),
                linear-gradient(180deg, var(--bg1), var(--bg2) 60%);
    color:#eee;
    -webkit-font-smoothing:antialiased;
    -moz-osx-font-smoothing:grayscale;
    overflow:hidden;
  }

  /* atmospheric decorative moon & bats */
  .sky{
    position:fixed; inset:0; pointer-events:none;
    background:
      radial-gradient(circle at 85% 15%, rgba(255,255,255,0.04) 0%, transparent 6%),
      radial-gradient(circle at 80% 18%, rgba(200,200,255,0.03) 0%, transparent 10%);
    mix-blend-mode: overlay;
  }
  .moon{
    position: absolute;
    right:4%;
    top:6%;
    width:140px;
    height:140px;
    border-radius:50%;
    background: linear-gradient(145deg,#fff2 #ddd8);
    opacity:0.08;
    filter:blur(2px);
    box-shadow: 0 0 40px rgba(185,20,47,0.06), inset -8px -6px 20px rgba(0,0,0,0.25);
    transform: rotate(-12deg);
  }
  .bats{
    position:absolute; left:6%; top:12%; width:300px; height:120px; opacity:0.12;
    background-image: radial-gradient(closest-side, transparent 60%, rgba(0,0,0,0.0)), url('data:image/svg+xml;utf8,\
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 80">\
        <path d=\"M10 40c20-20 40-20 60 0 20-20 40-20 60 0 0 0-10-6-20-6-10 0-20 8-30 8s-20-8-30-8c-10 0-20 6-20 6z\" fill=\"black\"/>\
      </svg>'); background-size:contain;background-repeat:no-repeat;
    transform:rotate(-8deg);
    animation: bats 12s linear infinite;
  }
  @keyframes bats{ 0%{transform:translateX(-30px) rotate(-6deg)} 50%{transform:translateX(30px) rotate(6deg)} 100%{transform:translateX(-30px) rotate(-6deg)} }

  /* container */
  #app{
    display:flex; flex-direction:column; align-items:center; justify-content:center;
    height:100vh; width:100vw; position:relative;
  }

  /* header */
  header{
    position:absolute; top:18px; left:18px; right:18px; display:flex; align-items:center; justify-content:space-between;
    pointer-events:auto;
  }
  .brand{
    display:flex; gap:12px; align-items:center;
    background:linear-gradient(90deg, rgba(255,255,255,0.02), rgba(255,255,255,0.015));
    padding:8px 12px; border-radius:12px; backdrop-filter: blur(6px);
    box-shadow: var(--glow);
  }
  .logo{
    width:44px;height:44px;border-radius:8px;background:linear-gradient(135deg,#1b0004,#3a0b12);
    display:flex;align-items:center;justify-content:center;font-weight:700;color:var(--accent);
    font-size:20px; box-shadow:0 6px 20px rgba(0,0,0,0.6) inset;
  }
  .title{font-weight:700; font-size:14px; color:#ffdfe6}
  .subtitle{font-size:11px;color:var(--muted)}

  .status{
    display:flex; gap:12px; align-items:center;
    background:var(--glass); padding:8px 12px; border-radius:12px;
  }
  .pill{padding:6px 10px;border-radius:999px;background:transparent;color:var(--muted);font-size:13px;border:1px solid rgba(255,255,255,0.03)}

  /* main pages container */
  .pages{
    width:100vw; height:100vh; display:flex; flex-direction:row; transition:transform .6s cubic-bezier(.2,.9,.2,1);
    will-change:transform;
  }

  .page{
    width:100vw; height:100vh; padding:48px; flex:0 0 100vw; display:flex; align-items:center; justify-content:center;
    position:relative;
  }

  /* card */
  .card{
    width:86%; max-width:1100px; min-width:320px; height:78vh; border-radius:18px; background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
    box-shadow: 0 20px 50px rgba(0,0,0,0.6), var(--glow);
    padding:36px; display:flex; flex-direction:column; gap:18px; position:relative;
    border:1px solid rgba(185,20,47,0.06); overflow:hidden;
  }

  .card:before{
    content:""; position:absolute; inset:0; background:radial-gradient(circle at 30% 10%, rgba(185,20,47,0.02), transparent 15%); pointer-events:none;
  }

  .qmeta{display:flex; justify-content:space-between; align-items:center; gap:12px}
  .qnum{font-size:18px; font-weight:700; color:#ffdfe6}
  .diff{font-size:12px; color:var(--muted); padding:6px 10px; border-radius:999px; background:rgba(255,255,255,0.02)}

  .question{
    font-size:28px; line-height:1.2; font-weight:700; letter-spacing:-0.5px; margin-top:6px;
    text-shadow: 0 2px 0 rgba(0,0,0,0.6);
  }
  .hint{font-size:13px;color:var(--muted); margin-top:4px}

  .options{
    display:grid; grid-template-columns:1fr 1fr; gap:14px; margin-top:18px; flex:1 1 auto;
  }
  .option{
    background:linear-gradient(180deg, rgba(255,255,255,0.015), rgba(255,255,255,0.01));
    border-radius:12px; padding:16px; display:flex; align-items:flex-start; gap:12px; cursor:pointer;
    border:1px solid rgba(255,255,255,0.02); transition:transform .14s ease, box-shadow .14s ease;
    user-select:none;
  }
  .option:hover{ transform:translateY(-6px); box-shadow:0 18px 40px rgba(0,0,0,0.6)}
  .option .label{width:36px;height:36px;border-radius:8px;background:linear-gradient(135deg,#2a0a12,#0c0204);display:flex;align-items:center;justify-content:center;font-weight:800;color:var(--accent);font-size:16px}
  .option .text{font-size:15px; color:#efe8ea}

  .option.correct { border:1px solid rgba(20,200,120,0.12); box-shadow:0 10px 30px rgba(20,200,120,0.04);}
  .option.wrong { opacity:0.6; filter:grayscale(0.25); border:1px solid rgba(200,20,20,0.08) }

  /* footer controls */
  .controls{display:flex; gap:12px; align-items:center; justify-content:space-between; margin-top:18px}
  .left-controls{display:flex; gap:10px; align-items:center}
  .btn{
    background:transparent; border-radius:10px; padding:10px 14px; border:1px solid rgba(255,255,255,0.04);
    color:var(--muted); cursor:pointer; font-weight:700;
  }
  .btn.primary{background:linear-gradient(90deg,var(--accent),#7b0b2a); color:#fff; box-shadow:var(--glow); border:0}
  .progress{
    height:12px; width:300px; background:rgba(255,255,255,0.02); border-radius:999px; overflow:hidden;
  }
  .progress > i{display:block;height:100%; background:linear-gradient(90deg,var(--accent), #7b0b2a); width:0%}

  .big-score{
    position:absolute; right:36px; bottom:36px; background:rgba(0,0,0,0.45); padding:18px;border-radius:14px;border:1px solid rgba(255,255,255,0.02);
    font-size:20px; font-weight:800; color:#ffdfe6;
  }

  /* final screen */
  .final{
    display:flex; flex-direction:column; align-items:center; justify-content:center; height:100%;
    gap:18px; text-align:center;
  }
  .final .result{ font-size:44px; font-weight:900; color:var(--accent); text-shadow:0 6px 30px rgba(185,20,47,0.15) }
  .final .detail{color:var(--muted); max-width:760px}

  /* responsive */
  @media (max-width:880px){
    .options{ grid-template-columns:1fr; }
    .card{ height:84vh; padding:20px }
    .question{ font-size:22px }
    .title{ font-size:13px }
  }

  /* keyboard hint */
  .kbd-hint{ position:absolute; left:18px; bottom:18px; color:var(--muted); font-size:13px }
</style>
</head>
<body>
<div class="sky" aria-hidden="true">
  <div class="moon"></div>
  <div class="bats"></div>
</div>

<div id="app" role="application" aria-label="생태 환경 퀴즈">
  <header>
    <div class="brand" aria-hidden="false">
      <div class="logo">🦇</div>
      <div>
        <div class="title">Nocturne Ecology Quiz</div>
        <div class="subtitle">생태·환경 — 뱀파이어 감성</div>
      </div>
    </div>
    <div class="status" aria-hidden="false">
      <div class="pill" id="qcount">문제 1 / 10</div>
      <div class="pill" id="difficulty">난이도: 보통</div>
    </div>
  </header>

  <div class="pages" id="pages" tabindex="0">
    <!-- pages generated by JS -->
  </div>

  <div class="big-score" id="bigScore" aria-live="polite">점수: 0</div>
  <div class="kbd-hint">키: ←/→ 이동 · 1-4 선택 · Enter 다음</div>
</div>

<script>
/* QUIZ DATA (Korean). 10 questions; two marked hard. */
const quiz = [
  {
    q: "생태계에서 '생산자'에 해당하는 생물군은 무엇인가요?",
    opts: ["육식성 포식자", "초식 동물", "광합성을 하는 식물 및 조류", "분해자 (세균·균류)"],
    a: 2,
    diff: "보통",
    hint: "생산자는 광합성을 통해 유기물을 생산합니다."
  },
  {
    q: "생물 다양성(생물다양성)이 높을 때 생태계에 기대되는 장점이 아닌 것은?",
    opts: ["시스템의 안정성 증가", "질병 확산 가능성 증가", "생산성 및 복원력 증가", "유전적 자원 보전이 용이"],
    a: 1,
    diff: "보통",
    hint: "다양성은 보통 병해충 저항성에 도움을 줍니다."
  },
  {
    q: "온실가스 중에서 가장 인간 활동으로 인해 증가하며 장기적으로 기후에 큰 영향을 미치는 가스는?",
    opts: ["이산화탄소(CO₂)", "메탄(CH₄)", "아산화질소(N₂O)", "산소(O₂)"],
    a: 0,
    diff: "보통",
    hint: "가장 넓게 배출되고 누적되는 기체입니다."
  },
  {
    q: "지구 생태계에서 '영양단계(trophic level)' 전이 시 에너지 전달 효율은 보통 어느 정도로 알려져 있나요?",
    opts: ["약 1~5%", "약 10~20%", "약 50~60%", "대략 80% 이상"],
    a: 1,
    diff: "보통",
    hint: "일반적으로 '10% 법칙'이라 부릅니다."
  },
  { // hard question 1
    q: "고난이도: 한 숲의 탄소 흡수량을 추정할 때 사용되는 단위와 개념으로 옳지 않은 것은?",
    opts: ["탄소 밀도 (tC/ha): 단위 면적당 저장된 탄소", "탄소 유출(선택적): 삼림 벌채로 즉시 대기로 방출되는 탄소량", "탄소 회수율: 광합성 속도로 1년에 흡수되는 탄소량을 의미", "탄소 속박률(carbon sequestration rate): 연간 저장 증가량"],
    a: 2,
    diff: "고난도",
    hint: "광합성 속도 자체는 흡수 속도를 말하지만 '회수율' 용어는 일반적이지 않습니다."
  },
  {
    q: "도시 열섬 현상을 완화하는 효과가 큰 도시 설계 요소로 옳지 않은 것은?",
    opts: ["녹지 및 도시숲 확장", "지붕·도로의 고반사(저알베도) 표면 적용", "고층 빌딩 밀집으로 그림자 증가", "도시 내부의 열 공기 배출을 막는 폐쇄형 설계"],
    a: 3,
    diff: "보통",
    hint: "열섬 완화를 위해서는 통풍과 반사, 녹지가 유리합니다."
  },
  {
    q: "해양 산성화의 주요 원인과 그 결과로 잘못 연결된 것은?",
    opts: ["대기 중 CO₂ 증가 → 해양의 pH 저하", "pH 저하 → 산호의 석회화 촉진", "pH 저하 → 조개류의 껍데기 형성 저해", "해양 생태계의 균형 교란"],
    a: 1,
    diff: "보통",
    hint: "산성화는 석회화에 장애를 줍니다."
  },
  {
    q: "생태계 복원에서 '기초종(keystone species)'의 역할로 옳은 것은?",
    opts: ["서식지의 물리적 구조를 만들지 못한다", "전체 생태계 구성에 과도한 영향을 가진다", "항상 먹이사슬 최상위에 위치한다", "개체 수가 많을수록 항상 기초종이다"],
    a: 1,
    diff: "보통",
    hint: "기초종은 생태계 내에서 상대적으로 적은 수라도 큰 영향을 미칩니다."
  },
  { // hard question 2
    q: "고난이도: 로지스틱 성장 모델 dN/dt = rN(1 - N/K)에서 'K'의 의미로 옳지 않은 진술은?",
    opts: ["K는 환경수용력이며 최대 개체수 한계", "K가 커지면 안정된 개체수는 더 커진다", "K는 개체군의 성장률 r과 동일하다", "환경 변화로 K는 시간에 따라 변할 수 있다"],
    a: 2,
    diff: "고난도",
    hint: "r과 K는 서로 다른 매개변수입니다."
  },
  {
    q: "플라스틱 쓰레기의 생태학적 영향으로 옳지 않은 것은?",
    opts: ["해양 생물의 섭식으로 인한 내부 장기 손상", "미세플라스틱이 먹이사슬을 통해 축적될 수 있음", "플라스틱은 생분해되어 자연에서 완전히 안전해짐", "플라스틱이 서식지를 물리적으로 변화시킬 수 있음"],
    a: 2,
    diff: "보통",
    hint: "대부분의 합성 플라스틱은 자연에서 쉽게 분해되지 않습니다."
  }
];

/* App state */
let current = 0;
let score = 0;
let answered = Array(quiz.length).fill(false);

const pagesEl = document.getElementById('pages');
const qcountEl = document.getElementById('qcount');
const diffEl = document.getElementById('difficulty');
const bigScoreEl = document.getElementById('bigScore');

/* Build pages */
function buildPages(){
  quiz.forEach((item, idx) => {
    const page = document.createElement('section');
    page.className = 'page';
    page.setAttribute('role','group');
    page.setAttribute('aria-label',`문제 ${idx+1}`);
    page.innerHTML = `
      <div class="card" data-index="${idx}">
        <div class="qmeta">
          <div>
            <div class="qnum">Q${idx+1}</div>
            <div class="diff" id="diff-${idx}">${item.diff}</div>
          </div>
          <div class="hint" id="hint-${idx}" aria-hidden="true">${item.hint || ''}</div>
        </div>

        <div class="question" id="question-${idx}">${escapeHtml(item.q)}</div>

        <div class="options" id="options-${idx}" role="list">
          ${item.opts.map((o,i) => `
            <div class="option" role="button" tabindex="0" data-idx="${i}" data-q="${idx}" aria-label="선택 ${i+1}">
              <div class="label">${['A','B','C','D'][i]}</div>
              <div class="text">${escapeHtml(o)}</div>
            </div>
          `).join('')}
        </div>

        <div class="controls" aria-hidden="false">
          <div class="left-controls">
            <button class="btn" data-action="prev">이전</button>
            <button class="btn" data-action="next">다음</button>
            <button class="btn" data-action="reveal">해설</button>
          </div>
          <div style="display:flex;gap:12px;align-items:center;">
            <div class="progress" aria-hidden="true"><i style="width:0%"></i></div>
            <div class="btn primary" data-action="skip">스킵</div>
          </div>
        </div>
      </div>
    `;
    pagesEl.appendChild(page);
  });

  // final page
  const final = document.createElement('section');
  final.className = 'page';
  final.innerHTML = `
    <div class="card final">
      <div class="result" id="finalScore">최종 점수: 0 / ${quiz.length}</div>
      <div class="detail" id="finalDetail">결과와 해설을 확인하고 싶으면 아래 버튼을 눌러주세요.</div>
      <div style="display:flex;gap:12px;margin-top:12px;">
        <button class="btn primary" id="restart">다시하기</button>
        <button class="btn" id="review">문제별 해설 보기</button>
      </div>
    </div>
  `;
  pagesEl.appendChild(final);

  attachHandlers();
  updateUI();
}

function escapeHtml(s){
  return s.replaceAll('&','&amp;').replaceAll('<','&lt;').replaceAll('>','&gt;');
}

/* Interaction */
function attachHandlers(){
  // click options
  pagesEl.addEventListener('click', (e) => {
    const opt = e.target.closest('.option');
    if(opt){
      const q = Number(opt.dataset.q);
      const i = Number(opt.dataset.idx);
      selectOption(q, i);
    }
    const btn = e.target.closest('button');
    if(btn && btn.dataset.action){
      handleAction(btn.dataset.action);
    }
  });

  // keyboard navigation
  window.addEventListener('keydown', (e) => {
    if(e.key === 'ArrowRight') { goto(current+1); e.preventDefault(); }
    if(e.key === 'ArrowLeft') { goto(current-1); e.preventDefault(); }
    if(['1','2','3','4'].includes(e.key)){
      const choice = Number(e.key) - 1;
      selectOption(current, choice);
    }
    if(e.key === 'Enter'){
      goto(current+1);
    }
  });

  // per-page option focus with Enter
  pagesEl.addEventListener('keydown', (e) => {
    if(e.key === 'Enter'){
      const focused = document.activeElement;
      if(focused && focused.classList.contains('option')){
        focused.click();
      }
    }
  });

  // restart/review
  document.addEventListener('click', (e) => {
    if(e.target.id === 'restart') resetQuiz();
    if(e.target.id === 'review') showReview();
  });

  // progress animation: update widths
  requestAnimationFrame(()=> {
    updateProgress();
  });
}

/* Select option */
function selectOption(qIndex, optionIndex){
  if(qIndex < 0 || qIndex >= quiz.length) return;
  const page = pagesEl.children[qIndex];
  if(!page) return;
  // prevent double scoring
  if(answered[qIndex]) return;
  answered[qIndex] = true;

  const correct = quiz[qIndex].a;
  const optionsEl = page.querySelectorAll('.option');
  optionsEl.forEach(el => {
    const idx = Number(el.dataset.idx);
    if(idx === correct) el.classList.add('correct');
    if(idx === optionIndex && idx !== correct) el.classList.add('wrong');
    el.setAttribute('aria-disabled','true');
  });

  // scoring: +1 correct
  if(optionIndex === correct){
    score++;
  }

  updateScoreUI();
  // small visual feedback
  const progressInner = page.querySelector('.progress > i');
  if(progressInner){
    progressInner.style.width = '100%';
  }

  // auto advance after short delay
  setTimeout(() => { goto(current+1); }, 700);
}

/* Actions */
function handleAction(action){
  if(action === 'prev') goto(current-1);
  if(action === 'next') goto(current+1);
  if(action === 'skip'){
    // mark answered but no score
    if(!answered[current] && current < quiz.length){
      answered[current] = true;
      const page = pagesEl.children[current];
      const opts = page.querySelectorAll('.option');
      opts.forEach(o => o.setAttribute('aria-disabled','true'));
      const p = page.querySelector('.progress > i');
      if(p) p.style.width = '100%';
    }
    goto(current+1);
  }
  if(action === 'reveal'){
    const page = pagesEl.children[current];
    const hint = page.querySelector(`#hint-${current}`);
    if(hint){
      hint.style.opacity = 1;
      hint.setAttribute('aria-hidden','false');
      hint.animate([{opacity:0},{opacity:1}],{duration:380});
    }
  }
}

/* goto page index */
function goto(idx){
  if(idx < 0) idx = 0;
  if(idx > quiz.length) idx = quiz.length; // final page index is quiz.length
  current = idx;
  const x = -idx * window.innerWidth;
  pagesEl.style.transform = \`translateX(\${x}px)\`;
  updateUI();
}

/* update UI elements */
function updateUI(){
  qcountEl.textContent = current < quiz.length ? \`문제 \${current+1} / \${quiz.length}\` : \`결과\`;
  diffEl.textContent = current < quiz.length ? quiz[current].diff : '-';
  bigScoreEl.textContent = \`점수: \${score}\`;

  // update aria focus for accessibility
  const page = pagesEl.children[current];
  if(page){
    // focus first option if not answered
    const firstOpt = page.querySelector('.option');
    if(firstOpt) firstOpt.focus();
  }

  // if final screen
  if(current === quiz.length){
    const finalScoreEl = document.getElementById('finalScore');
    finalScoreEl.textContent = \`최종 점수: \${score} / \${quiz.length}\`;
  }

  updateProgress();
}

/* update per-page progress visuals */
function updateProgress(){
  const total = quiz.length;
  for(let i=0;i<total;i++){
    const page = pagesEl.children[i];
    if(!page) continue;
    const p = page.querySelector('.progress > i');
    if(!p) continue;
    p.style.width = answered[i] ? '100%' : '0%';
  }
}

/* update score UI */
function updateScoreUI(){
  bigScoreEl.animate([{transform:'scale(1)'},{transform:'scale(1.06)'},{transform:'scale(1)'}],{duration:360});
  bigScoreEl.textContent = \`점수: \${score}\`;
}

/* reset */
function resetQuiz(){
  current = 0; score = 0; answered = Array(quiz.length).fill(false);
  // clear option classes
  for(let i=0;i<quiz.length;i++){
    const page = pagesEl.children[i];
    if(!page) continue;
    const opts = page.querySelectorAll('.option');
    opts.forEach(o => { o.classList.remove('correct','wrong'); o.removeAttribute('aria-disabled'); });
    const p = page.querySelector('.progress > i');
    if(p) p.style.width = '0%';
    const hint = page.querySelector(`#hint-${i}`);
    if(hint) { hint.style.opacity = 0; hint.setAttribute('aria-hidden','true'); }
  }
  updateUI();
  goto(0);
}

/* review: show answers + explanations (simple) */
function showReview(){
  // open a modal-like overlay by moving to first page and revealing all correct answers
  for(let i=0;i<quiz.length;i++){
    const page = pagesEl.children[i];
    const opts = page.querySelectorAll('.option');
    const correct = quiz[i].a;
    opts.forEach(o => {
      const idx = Number(o.dataset.idx);
      if(idx === correct) o.classList.add('correct');
      o.setAttribute('aria-disabled','true');
    });
  }
  goto(0);
}

/* init */
buildPages();
goto(0);

/* accessibility: respond to resize to keep transform valid */
window.addEventListener('resize', ()=> {
  const x = -current * window.innerWidth;
  pagesEl.style.transition = 'none';
  pagesEl.style.transform = \`translateX(\${x}px)\`;
  requestAnimationFrame(()=> pagesEl.style.transition = '');
});

</script>
</body>
</html>
